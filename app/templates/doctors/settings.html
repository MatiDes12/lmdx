{% extends 'doctors/dashboard.html' %}

{% block title %}Healthcare Dashboard Settings{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-6">Healthcare Dashboard Settings</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} mb-4 p-4 rounded-lg {% if category == 'success' %}bg-green-100 text-green-700{% elif category == 'error' %}bg-red-100 text-red-700{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form action="{{ url_for('doctors.settings') }}" method="POST" id="settings-form">
        <!-- General Settings -->
        <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl font-semibold mb-4">General Settings</h2>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="language">
                    Language
                </label>
                <select name="language" id="language" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    <option value="en" {% if settings.language == 'en' %}selected{% endif %}>English</option>
                    <option value="es" {% if settings.language == 'es' %}selected{% endif %}>Spanish</option>
                    <option value="fr" {% if settings.language == 'fr' %}selected{% endif %}>French</option>
                </select>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="timezone">
                    Timezone
                </label>
                <select name="timezone" id="timezone" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    {% for tz in timezones %}
                        <option value="{{ tz }}" {% if settings.timezone == tz %}selected{% endif %}>{{ tz }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-4">
                <label class="flex items-center">
                    <input type="checkbox" name="dark_mode" id="dark_mode" {% if settings.dark_mode %}checked{% endif %} class="form-checkbox">
                    <span class="ml-2">Enable Dark Mode</span>
                </label>
            </div>
        </div>

        <!-- Patient Management Settings -->
        <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl font-semibold mb-4">Patient Management Settings</h2>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="default_view">
                    Default Patient View
                </label>
                <select name="default_view" id="default_view" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    <option value="list" {% if settings.default_patient_view == 'list' %}selected{% endif %}>List View</option>
                    <option value="grid" {% if settings.default_patient_view == 'grid' %}selected{% endif %}>Grid View</option>
                </select>
            </div>
            <div class="mb-4">
                <label class="flex items-center">
                    <input type="checkbox" name="show_inactive" {% if settings.show_inactive_patients %}checked{% endif %} class="form-checkbox">
                    <span class="ml-2">Show Inactive Patients</span>
                </label>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="records_per_page">
                    Records Per Page
                </label>
                <input type="number" name="records_per_page" id="records_per_page" value="{{ settings.records_per_page }}" min="10" max="100" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            </div>
        </div>

        <!-- Doctor Management Settings -->
        <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl font-semibold mb-4">Doctor Management Settings</h2>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="specialization_filter">
                    Default Specialization Filter
                </label>
                <select name="specialization_filter" id="specialization_filter" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    <option value="all" {% if settings.default_specialization_filter == 'all' %}selected{% endif %}>All Specializations</option>
                    {% for specialization in specializations %}
                        <option value="{{ specialization }}" {% if settings.default_specialization_filter == specialization %}selected{% endif %}>{{ specialization }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-4">
                <label class="flex items-center">
                    <input type="checkbox" name="show_schedule" {% if settings.show_doctor_schedules %}checked{% endif %} class="form-checkbox">
                    <span class="ml-2">Show Doctor Schedules by Default</span>
                </label>
            </div>
        </div>

        <!-- Analytics Settings -->
        <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl font-semibold mb-4">Analytics Settings</h2>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="default_chart">
                    Default Chart Type
                </label>
                <select name="default_chart" id="default_chart" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    <option value="bar" {% if settings.default_chart_type == 'bar' %}selected{% endif %}>Bar Chart</option>
                    <option value="line" {% if settings.default_chart_type == 'line' %}selected{% endif %}>Line Chart</option>
                    <option value="pie" {% if settings.default_chart_type == 'pie' %}selected{% endif %}>Pie Chart</option>
                </select>
            </div>
            <div class="mb-4">
                <label class="flex items-center">
                    <input type="checkbox" name="auto_refresh" {% if settings.auto_refresh_analytics %}checked{% endif %} class="form-checkbox">
                    <span class="ml-2">Enable Auto-Refresh for Analytics</span>
                </label>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="refresh_interval">
                    Refresh Interval (minutes)
                </label>
                <input type="number" name="refresh_interval" id="refresh_interval" value="{{ settings.refresh_interval }}" min="1" max="60" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            </div>
        </div>

        <!-- Notification Settings -->
        <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl font-semibold mb-4">Notification Settings</h2>
            <div class="mb-4">
                <label class="flex items-center">
                    <input type="checkbox" name="email_notifications" id="email_notifications" {% if settings.email_notifications %}checked{% endif %} class="form-checkbox">
                    <span class="ml-2">Receive Email Notifications</span>
                </label>
            </div>
            <div class="mb-4">
                <label class="flex items-center">
                    <input type="checkbox" name="sms_notifications" id="sms_notifications" {% if settings.sms_notifications %}checked{% endif %} class="form-checkbox">
                    <span class="ml-2">Receive SMS Notifications</span>
                </label>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="notification_frequency">
                    Notification Frequency
                </label>
                <select name="notification_frequency" id="notification_frequency" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    <option value="immediately" {% if settings.notification_frequency == 'immediately' %}selected{% endif %}>Immediately</option>
                    <option value="daily" {% if settings.notification_frequency == 'daily' %}selected{% endif %}>Daily Digest</option>
                    <option value="weekly" {% if settings.notification_frequency == 'weekly' %}selected{% endif %}>Weekly Summary</option>
                </select>
            </div>
        </div>

        <!-- Security Settings -->
        <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl font-semibold mb-4">Security Settings</h2>
            <div class="mb-4">
                <label class="flex items-center">
                    <input type="checkbox" name="two_factor_auth" {% if settings.two_factor_auth %}checked{% endif %} class="form-checkbox">
                    <span class="ml-2">Enable Two-Factor Authentication</span>
                </label>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="session_timeout">
                    Session Timeout (minutes)
                </label>
                <input type="number" name="session_timeout" id="session_timeout" value="{{ settings.session_timeout }}" min="5" max="120" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="password_expiry">
                    Password Expiry (days)
                </label>
                <input type="number" name="password_expiry" id="password_expiry" value="{{ settings.password_expiry }}" min="30" max="365" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            </div>
        </div>

        <div class="flex items-center justify-between">
            <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                Save Settings
            </button>
        </div>
    </form>
</div>
{% endblock %}